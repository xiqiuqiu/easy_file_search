# 🌍 多语言支持说明

本项目提供了完整的多语言支持，让不同语言的用户都能方便地使用Excel关键词搜索工具。

## 📋 支持的语言

- 🇨🇳 **中文 (简体)** - 默认语言
- 🇺🇸 **English** - 英语支持

## 🚀 快速开始

### 方法一：使用启动脚本（推荐）

**Windows用户：**
```
双击 start.bat 文件
```

**macOS/Linux用户：**
```bash
chmod +x start.sh
./start.sh
```

### 方法二：直接运行

**多语言版本（推荐）：**
```bash
python excel_gui_search_i18n.py
```

**基础版本：**
```bash
python excel_gui_search.py
```

## ⚙️ 语言设置

### 自动检测
程序会在首次启动时自动检测系统语言：
- 中文系统 → 自动使用中文界面
- 英文系统 → 自动使用英文界面
- 其他系统 → 默认使用中文界面

### 手动切换
在程序运行时，您可以通过以下方式切换语言：

1. **菜单栏切换**：
   - 点击菜单栏中的语言选项
   - 选择您需要的语言
   - 界面会立即更新

2. **设置保存**：
   - 语言设置会自动保存到配置文件
   - 下次启动时会使用您上次选择的语言

## 📁 文件结构

```
locales/                    # 语言文件目录
├── en.json                # 英文翻译文件
└── zh_CN.json             # 中文翻译文件

i18n.py                    # 国际化模块
config.py                  # 配置管理
excel_gui_search_i18n.py   # 多语言版本主程序
config.json                # 用户配置文件（自动生成）
```

## 🔧 技术实现

### 翻译系统
- **JSON格式**：使用JSON文件存储翻译文本
- **键值映射**：每个界面元素都有对应的翻译键
- **动态加载**：支持运行时切换语言

### 配置管理
- **自动保存**：用户偏好自动保存到本地
- **智能检测**：自动检测系统语言设置
- **持久化**：设置在程序重启后保持

## 🌟 功能特性

### 界面本地化
- ✅ 窗口标题
- ✅ 菜单项
- ✅ 按钮文本
- ✅ 标签说明
- ✅ 消息框提示
- ✅ 状态栏信息
- ✅ 表格列标题

### 消息本地化
- ✅ 错误提示
- ✅ 成功消息
- ✅ 警告信息
- ✅ 搜索结果统计

## 🛠️ 开发者指南

### 添加新语言

1. **创建翻译文件**：
   ```bash
   # 复制现有翻译文件
   cp locales/en.json locales/新语言代码.json
   ```

2. **翻译内容**：
   ```json
   {
       "app_title": "您的翻译",
       "search_path": "您的翻译",
       // ... 其他翻译
   }
   ```

3. **更新语言列表**：
   在 `i18n.py` 中的 `get_language_name()` 函数添加新语言。

### 添加新的翻译键

1. **在翻译文件中添加**：
   ```json
   {
       "new_key": "翻译文本"
   }
   ```

2. **在代码中使用**：
   ```python
   from i18n import t
   text = t('new_key')
   ```

## 🐛 常见问题

### Q: 为什么语言切换后部分文本没有更新？
A: 确保所有界面元素都使用了 `t()` 函数，并且翻译文件中包含对应的键。

### Q: 如何重置语言设置？
A: 删除 `config.json` 文件，程序会重新检测系统语言。

### Q: 支持添加更多语言吗？
A: 是的！按照开发者指南添加新的翻译文件即可。

## 📞 技术支持

如果您在使用多语言功能时遇到问题：

1. **检查文件**：确保 `locales/` 目录和翻译文件存在
2. **查看日志**：运行时的错误信息会显示在控制台
3. **重置配置**：删除 `config.json` 文件重新开始
4. **提交Issue**：在GitHub上报告问题

---

💡 **提示**：多语言版本包含所有基础功能，推荐使用 `excel_gui_search_i18n.py` 获得最佳体验！
